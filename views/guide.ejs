<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phantom ACO - Submission Guide</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      /* Styles from the original guide.html, adapted for the dashboard */
      .guide-container {
          max-width: 800px;
          margin: 2rem auto;
          background-color: var(--surface);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-md);
          border: 1px solid var(--border);
          overflow: hidden;
      }
      .guide-header {
          background: linear-gradient(135deg, var(--brand-500), var(--brand-400));
          color: white;
          padding: 2.5rem 2rem;
          text-align: center;
      }
      .guide-header h1 {
          margin: 0;
          font-size: 2.25rem;
          font-weight: 700;
      }
      .guide-header p {
          margin: 0.5rem 0 0;
          opacity: 0.9;
      }
      .guide-content {
          padding: 2.5rem;
      }
      .guide-section {
          margin-bottom: 3rem;
      }
      .guide-section h2 {
          font-size: 1.75rem;
          font-weight: 700;
          color: var(--text-900);
          border-bottom: 1px solid var(--border);
          padding-bottom: 0.75rem;
          margin-bottom: 1.5rem;
      }
      .guide-section h3 {
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-900);
          margin-top: 2rem;
          margin-bottom: 1rem;
      }
      .field-list {
          list-style: none;
          padding: 0;
          margin: 0;
      }
      .field-list li {
          padding: 0.75rem 0;
          border-bottom: 1px solid var(--border);
          display: flex;
          justify-content: space-between;
          align-items: center;
      }
      .field-list li:last-child {
          border-bottom: none;
      }
      .field-name {
          font-weight: 600;
          color: var(--text-900);
      }
      .field-desc {
          font-size: 0.9rem;
          color: var(--muted);
          text-align: right;
      }
      .info-box {
          background-color: rgba(59, 130, 246, 0.1);
          border-left: 4px solid #3b82f6;
          padding: 1.25rem;
          margin: 1.5rem 0;
          border-radius: 4px;
          color: var(--text-700);
      }
      .info-box a {
          color: #60a5fa;
          text-decoration: none;
          font-weight: 600;
      }
      .info-box a:hover {
          text-decoration: underline;
      }
      .code-block {
          background-color: var(--bg);
          padding: 1rem;
          border-radius: 8px;
          position: relative;
          border: 1px solid var(--border);
          margin: 1rem 0;
      }
      .code-block code {
          font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
          font-size: 0.95rem;
          color: var(--text-700);
      }
    </style>
  </head>
  <body>
    <div class="shell">
      <!-- Header -->
      <header class="header">
        <div class="header-inner">
          <div class="brand">
            <% if (logo && logo.startsWith('/uploads/')) { %>
              <img src="<%= logo %>" alt="Logo" style="width: 80px; height: 80px; border-radius: 8px; object-fit: contain; margin-right: 12px;">
            <% } else { %>
              <div style="font-size: 3.6rem; margin-right: 8px;"><%= logo || 'üëª' %></div>
            <% } %>
            <span class="brand-name"><%= brandName || 'Phantom ACO' %></span>
          </div>
          <div class="header-actions">
            <% if (userServers && userServers.length > 1) { %>
            <div style="position: relative;">
              <select id="server-selector" style="padding: 8px 12px; background: var(--surface-100); border: 1px solid var(--border); border-radius: 8px; color: var(--text-900); font-size: 0.9rem; cursor: pointer;">
                <% userServers.forEach(server => { %>
                  <option value="<%= server.server_id %>" <%= selectedServer && selectedServer.server_id === server.server_id ? 'selected' : '' %>>
                    üñ•Ô∏è <%= server.server_name %>
                  </option>
                <% }); %>
              </select>
            </div>
            <% } %>
            <div class="chip">
              <% if (user.discord_avatar) { %>
                <img src="https://cdn.discordapp.com/avatars/<%= user.discord_id %>/<%= user.discord_avatar %>.png" alt="Avatar" style="width:24px; height:24px; border-radius:50%;">
              <% } %>
              <%= user.discord_username %>
            </div>
            <a href="/auth/logout" class="btn btn-ghost">Logout</a>
          </div>
        </div>
      </header>
  
      <!-- Main Content -->
      <div class="container">
        <div class="toolbar">
          <h1 class="title">Submission Guide</h1>
          <a href="/dashboard" class="btn btn-primary">‚Üê Back to Dashboard</a>
        </div>
  
        <div class="guide-container">
          <div class="guide-header">
              <h1>Complete Submission Guide</h1>
              <p>Your step-by-step guide to filling out your information securely.</p>
          </div>
  
          <div class="guide-content">
              <div class="guide-section">
                  <h2>Login Required Services & IMAP</h2>
                  <p>For some services, we need to log into a retail account for you (e.g., Target, Best Buy). To do this securely without needing your direct account password, we use a special "App Password" for services like Gmail.</p>
                  
                  <h3>Generating a Gmail App Password for Login Services</h3>
                  <div class="info-box">
                      To find a Gmail app password for IMAP, go to your Google Account's "App passwords" page at <a href="https://myaccount.google.com/apppasswords" target="_blank" rel="noopener noreferrer">myaccount.google.com/apppasswords</a>.
                      You may need to enable 2-Step Verification first. Then, click "Generate". Select "Mail" for the app and "Other (Custom name)" for the device, give it a name like "ACO Service", and a 16-digit password will be created.
                  </div>
                  <p>Please enter this 16-digit app password in the "App Password" field when you are submitting your information. This allows us to verify your checkout confirmations without ever accessing your main password.</p>
                  <ul class="field-list">
                      <li><span class="field-name">Retailer Account Username:</span> <span class="field-desc">The Gmail address you use for the retailer's website.</span></li>
                      <li><span class="field-name">App Password:</span> <span class="field-desc">The 16-digit app password generated from your Google Account.</span></li>
                  </ul>
              </div>
  
               <div class="guide-section">
                  <h2>General Information (Pre-filled)</h2>
                  <p>When you open the submission form from the dashboard, some fields will be automatically filled for you. You don't need to change these.</p>
                  <ul class="field-list">
                      <li><span class="field-name">Discord ID:</span> <span class="field-desc">Your unique Discord user ID.</span></li>
                      <li><span class="field-name">Discord Username:</span> <span class="field-desc">Your Discord username.</span></li>
                      <li><span class="field-name">Service Name:</span> <span class="field-desc">The name of the service you're subscribing to.</span></li>
                  </ul>
              </div>
          </div>
        </div>
      </div>
    </div>
  
    <script>
      // Server switcher logic (same as dashboard)
      const serverSelector = document.getElementById('server-selector');
      if (serverSelector) {
        serverSelector.addEventListener('change', async (e) => {
          const serverId = e.target.value;
          try {
            const response = await fetch('/dashboard/switch-server', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              credentials: 'same-origin',
              body: JSON.stringify({ serverId })
            });
            if (response.ok) {
              window.location.reload();
            } else {
              alert('Failed to switch server.');
            }
          } catch (error) {
            console.error('Error switching server:', error);
            alert('An error occurred while switching servers.');
          }
        });
      }
    </script>
  </body>
  </html>
